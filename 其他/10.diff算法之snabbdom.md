# 10.diff 算法之 snabbdom.md





## start

在 Vue的源码中，和diff算法有关的文件顶部，又说到借鉴了 snabbdom，学习diff算法之前，我们先去看看这个库的源码。







## 相关信息



snabbdom [github网址](https://github.com/snabbdom/snabbdom/)

snabbdom 本身是使用 TS编写的， snabbdom 的npm包是提供了build之后的js版本的对应代码。所以我们采用npm包的形式去学习了解 snabbdom 的原理。







## 尝试运行使用示例

然后我们去尝试运行一下 snabbdom  官方提供的示例



```js
import {
  init,
  classModule,
  propsModule,
  styleModule,
  eventListenersModule,
  h,
} from "snabbdom";

const patch = init([
  // 通过传入模块初始化 patch 函数
  classModule, // 开启 classes 功能
  propsModule, // 支持传入 props
  styleModule, // 支持内联样式同时支持动画
  eventListenersModule, // 添加事件监听
]);

const container = document.getElementById("container");

const vnode = h("div#container.two.classes", { on: { click: someFn } }, [
  h("span", { style: { fontWeight: "bold" } }, "This is bold"),
  " and this is just normal text",
  h("a", { props: { href: "/foo" } }, "I'll take you places!"),
]);
// 传入一个空的元素节点 - 将产生副作用（修改该节点）
patch(container, vnode);

const newVnode = h(
  "div#container.two.classes",
  { on: { click: anotherEventHandler } },
  [
    h(
      "span",
      { style: { fontWeight: "normal", fontStyle: "italic" } },
      "This is now italic type"
    ),
    " and this is still just normal text",
    h("a", { props: { href: "/bar" } }, "I'll take you places!"),
  ]
);
// 再次调用 `patch`
patch(vnode, newVnode); // 将旧节点更新为新节点
```



1. 看到开头的  `import {xxx} from "snabbdom" ` 可以理解到，这里使用的是 ES6的模块化。

2. 看到`document.getElementById("container");` 此示例需要结合 html页面一起演示。

3. 处理一下js中的一些需要我们改动的地方`someFn`，`anotherEventHandler`。



综合上述的说明：



index.html

```html


```

